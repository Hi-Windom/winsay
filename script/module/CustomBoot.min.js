import*as config from"../config.js";import*as API from"./../utils/api.min.js";var fs=null,oncePath=`${config.winsay_ROOT_ABS}\\script\\module\\AlertOnce.js`;API.isAppMode()&&(fs=require("fs")),fs&&fs.access(oncePath,(function(e){if(!e)return window.funs.loadScript(window.funs.addURLParam("/appearance/themes/Sofill-/script/module/AlertOnce.js"),void 0,!0),void setTimeout((()=>{fs.unlink(oncePath,(function(e){if(e)throw e}))}),3e3)}));let SC_winsay_cp_appearance__TabBarMode=localStorage.getItem("SC_winsay_cp_appearance__TabBarMode");async function ghostTabBar(){API.isEmpty(SC_winsay_cp_appearance__TabBarMode)?new Promise((function(e){var a=new XMLHttpRequest;a.open("POST","http://127.0.0.1:6806/api/file/getFile",!0),a.setRequestHeader("Content-type","application/json");var t={path:config.config_UI};a.send(JSON.stringify(t)),a.onreadystatechange=function(){if(4==a.readyState&&200==a.status){var t=a.responseText;e(JSON.parse(t))}}})).then((function(e){window.funs.updateStyle("TabBar",`/appearance/themes/Sofill-/style/sweet/${e.style.TabBar}`)})):window.funs.updateStyle("TabBar",`/appearance/themes/Sofill-/style/sweet/${SC_winsay_cp_appearance__TabBarMode}`)}switch(ghostTabBar(),window.funs.updateStyle("MI","/appearance/themes/Sofill-/style/MI.min.css"),window.theme.OS){case"android":window.funs.updateStyle("MI-DocTree","/appearance/themes/Sofill-/style/MI-DocTree.css"),window.funs.updateStyle("MI-Doc&Breadcrumb","/appearance/themes/Sofill-/style/MI-Doc.css"),window.funs.updateStyle("Mobile","/appearance/themes/Sofill-/style/android/Mobile.css");break;default:window.funs.updateStyle("MI-DocTree","/appearance/themes/Sofill-/style/MI-DocTree.css"),window.funs.updateStyle("MI-Doc&Breadcrumb","/appearance/themes/Sofill-/style/MI-Doc.css");break}switch(window.funs.updateStyle("Init","/appearance/themes/Sofill-/style/Init.min.css"),window.funs.updateStyle("SCC","/appearance/themes/Sofill-/style/SCC.min.css"),window.funs.updateStyle("Popup","/appearance/themes/Sofill-/style/Popup.min.css"),window.funs.updateStyle("Patch","/appearance/themes/Sofill-/style/Patch.css"),window.funs.updateStyle("MI-ToolBar-Auto","/appearance/themes/Sofill-/style/sweet/MI-ToolBar-Auto.css"),window.funs.updateStyle("MI-TabBar-Common","/appearance/themes/Sofill-/style/MI-TabBar-Common.css"),window.funs.updateStyle("MI-TagTree","/appearance/themes/Sofill-/style/MI-TagTree.css"),window.funs.updateStyle("MI-HDTree","/appearance/themes/Sofill-/style/MI-HDTree.css"),window.funs.updateStyle("MI-Dock","/appearance/themes/Sofill-/style/MI-Dock.css"),window.funs.updateStyle("MI-Dynamic","/appearance/themes/Sofill-/style/MI-Dynamic.css"),window.funs.updateStyle("Funs-list2","/appearance/themes/Sofill-/style/Funs-list2.min.css"),window.funs.updateStyle("Funs-ScrollView","/appearance/themes/Sofill-/style/Funs-ScrollView.css"),window.funs.updateStyle("CP","/appearance/themes/Sofill-/style/CP.min.css"),config.ThemeName){case"Sofill=":window.funs.updateStyle("CP-lili","/appearance/themes/Sofill=/style/CP-lili.css");break;case"Sofill-":default:window.funs.updateStyle("CP-winsay","/appearance/themes/Sofill-/style/CP-winsay.css");break}var kernelVersion=window.siyuan.config.system.kernelVersion,oldVersion="2.5.2",cv_result=API.compareVersion(oldVersion,kernelVersion),AutoCheckSilently=localStorage.getItem("SC_winsay_cp_search__about_AutoCheckSilently");switch(cv_result){case 1:case 0:AutoCheckSilently&&"true"==AutoCheckSilently||setTimeout((()=>{API.通知(`主题已停止支援思源 ${oldVersion} 及更早版本，建议更新思源版本<br><a href="https://github.com/Hi-Windom/winsay/issues?q=is%3Aissue+label%3AAbolishment+is%3Aclosed" target="_blank" style="color: #58c">更多信息</a>`,8e3)}),3e3);break;default:break}let inited=localStorage.getItem("SC_winsay_cp_inited");"true"!=inited&&(localStorage.setItem("SC_winsay_cp_system__SelfProtection","true"),localStorage.setItem("SC_winsay_cp_editor__LH_Adaptive","true"),localStorage.setItem("SC_winsay_cp_editor__ListAutoIndent","true"),localStorage.setItem("SC_winsay_cp_editor__HintHint-index","true"),localStorage.setItem("SC_winsay_cp_editor__BlockTable_FontSize","92%"),localStorage.setItem("SC_winsay_cp_editor__Block-Inline-link__block-ref-content","⁅⁅ ⁆⁆"),localStorage.setItem("SC_winsay_cp_editor__block__popover--open__PinSense","1"),localStorage.setItem("SC_winsay_cp_appearance__ToolBarMode__NotFocus__bgColor","var(--b3-theme-surface-lighter)"),localStorage.setItem("SC_winsay_cp_appearance__ShowWebIcon","true"),localStorage.setItem("SC_winsay_cp_appearance__ShowFileIcon","true"),localStorage.setItem("SC_winsay_cp_appearance__status_msg_opacity","0.9"),localStorage.setItem("SC_winsay_cp_appearance__strengthen_backlinkList_panel_border","true"),localStorage.setItem("SC_winsay_cp_filetree__Adaptive_display","true"),localStorage.setItem("SC_winsay_cp_search__index","true"),localStorage.setItem("SC_winsay_cp_search__layout","layout-Auto.css"),localStorage.setItem("SC_winsay_cp_inited","true"));